<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Embracing Service Oriented Patterns in Apex</title>

		<meta name="description" content="Cactusforce19 Service Oriented Architecture presentation">
		<meta name="author" content="Don Robins">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
						<h2>Embracing </br>Service Oriented Patterns</br> in Apex</h2>
						<h8>(or how to avoid <i>Mondo-mania</i>)</h8>
				</section>

				<section data-transition="slide">
						<h4>Don Robins</h4>
						<p/>
						<h8>Technical Educator</h8><br/>
						<h8>5x Salesforce MVP</h8><br/>
						<h8>Certified Instructor/PDII</h8><br/>
						<h8>Salesforce Training Partner</h8><br/>
						<h8>Pluralsight Author and Producer</h8><br/>
						<h8>Books, Posts, Articles</h8><br/>
				</section>

				<section data-transition="slide-in fade-out">
					<h3>What's my goal?</h3>
				</section>

				<section data-background-image="img/clockwork_orange.gif" data-transition="fade-in fade-out">
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					
					<h3>To open your eyes</h3>
					<div style="font-size: 15px;"><i>"A Clockwork Orange" &#9400; 1971 - courtesy of Warner Bros.</i></div>
				</section>

				<section data-transition="fade-in fade-out">
					<h4>...and to expose and encourage you to:</h3>
					<h8 class="fragment">Explore software development patterns</h8><br/>
					<h8 class="fragment">by layering your code base</h8><br/>
					<h8 class="fragment">and decoupling complexity in your org</h8><br/>										
				</section>

				<section data-transition="slide-in fade-out">
					<h3>What's NOT my goal?</h3>
				</section>

				<section data-background-image="img/clockwork_orange.gif" data-transition="fade-in fade-out">
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					<br/>
					
					<h3>To brainwash you</h3>
					<div style="font-size: 15px;"><i>"A Clockwork Orange" &#9400; 1971 - courtesy of Warner Bros.</i></div>
				</section>

				<section data-transition="fade-in fade-out">
					<h4>...and to convince you to:</h3>
					<h8 class="fragment">Migrate to a complex architectural framework</h8><br/>
					<h8 class="fragment">requiring you to refactor your entire code base</h8><br/>
					<h8 class="fragment">and maxing out the Apex code limit in your org</h8><br/>										
				</section>

				<section data-transition="slide-in fade-out">
					<h3>Let's identify the problem...</h3>
				</section>

				<section data-transition="slide-in fade-out">
					<img src="img/Mongo.jpg" />	

					<h4 class="fragment fade-in">
						MONGO
					</h4>	

					<!--
					<p class="fragment fade-in">
						<i>MONGO</i>
					</p>	
					-->	
				</section>
	
				<section data-transition="fade-in slide-out" >
					<img src="img/blazing_saddles_movie_poster_big.jpg" />	
					<div style="font-size: 12px;"><i>Courtesy of Warner Bros.</i></div>
				</section>
	
				<section data-transition="fade-in fade-out">

					<H4>MONGO</H4>	
					<img src="img/mongopiano.gif" />	
					
					<p class="fragment fade-in">
						<i>hu-MONGO-us</i>
					</p>

					<p class="fragment fade-in">
						MONGO == BAD
					</p>
				</section>

				<section data-transition="slide-in fade-out">
					<h3>Mongo ~ Mondo</h3>
				</section>

				<section data-transition="fade-in fade-out">
						<img src="img/Definition_of_Mondo.jpg" />	
				</section>
	
				<section data-transition="slide-in fade-out">
					<h3>mondo-mania</h3><h6><i> noun</i></h6> 
					<h6><i>the preponderance of <br/>oodles and oodles of content <br/>in any one programmatic construct.</i></h6>
				</section>

				<section data-transition="slide-in fade-out">
					<h3>Mondo-mania <br/>(like Mongo) <br/>is <i>BAD!</i></h3>
				</section>

				<section data-transition="fade-in fade-out">
					<h4>Where is mondo-mania found in Salesforce?</h4>
					<h8 class="fragment fade-in">Apex Triggers</h8><br/>
					<h8 class="fragment fade-in">Apex Classes and Methods</h8><br/>
					<h8 class="fragment fade-in">Visualforce Pages</h8><br/>
				</section>

				<section data-transition="fade-in fade-out">
					<h4>Where is mondo-mania found in Salesforce?</h4>
					<h8>Apex Triggers</h8><br/>
					<h8>Apex Classes and Methods</h8><br/>
					<h8 style="text-decoration: line-through; color:grey">Visualforce Pages</h8><br/>
				</section>

				<section data-transition="fade-in fade-out">
					<h4>What are mondo-mania code smells?</h4>
					<h8 class="fragment fade-in">Excessive line length</h8><br/>
					<h8 class="fragment fade-in">Excessive conditional branching</h8><br/>
					<h8 class="fragment fade-in">Excessive loops</h8><br/>
					<h8 class="fragment fade-in">Excessive DML operations </h8><br/>
				</section>

				<section data-transition="fade-in fade-out">
					<h4>What are mondo-mania code smells?</h4>
					<h8><span style="color:red">Excessive</span> line length</h8><br/>
					<h8><span class="fragment highlight-red">Excessive</span> conditional branching</h8><br/>
					<h8><span class="fragment highlight-red">Excessive</span> loops</h8><br/>
					<h8><span class="fragment highlight-red">Excessive</span> DML operations </h8><br/>
				</section>

				<section data-transition="fade-in fade-out">
						<h3>What is a<br/>Code Smell?</h3>
				</section>
				
				<section data-transition="fade-in fade-out">
					<h3 style="color:white">code smell</h3>
					<h6 style="color:white"><i> noun</i></h6> 
					<p style="color:white"><i>a characteristic of source code <br/>suggesting a deeper problem.</i></p>
				</section>

				<section data-transition="fade-in fade-out"
						 data-background-iframe="https://en.wikipedia.org/wiki/Code_smell" 
						 data-background-interactive >
				</section>

				<section data-transition="slide-in fade-out">
					<h3>Let's sniff out an example...</h3>
				</section>

			    <section data-transition="slide-in fade-out">
					<h4>A Real Mondo Method</h4>
					<style type="text/css">
						.gist {width:100% !important;}
						.gist-file
						.gist-data {max-height: 500px;max-width: 100%;}
					</style>
					<script src="https://gist.github.com/forcementor/ad970b3693c973573d18faa56a6b360d.js"></script>

			    </section>

				<section data-transition="slide-in fade-out">
					<h3>What is the solution?</h3>
				</section>


				<!-- 15 MINS 20 % -->

				<section data-transition="fade-in fade-out">
						<h1>SOC</h1>
				</section>
					
				<section data-transition="fade-in fade-out">
						<h3>Separation of Concerns</h3>
				</section>
				
				<section data-transition="fade-in fade-out">
						<h3>What is <br/>Separation of Concerns?</h3>
				</section>
				
				<section data-transition="fade-in fade-out">
					<h3 style="color:white">separation of concerns</h3>
					<h6 style="color:white"><i> noun</i></h6> 
					<p style="color:white"><i>a design principal of breaking down code <br/>into distinct sections, each addressing a concern.</i></p>
				</section>

				<section data-transition="fade-in fade-out"
						 data-background-iframe="https://en.wikipedia.org/wiki/Separation_of_concerns" 
						 data-background-interactive >

				</section>

				<section data-transition="fade-in fade-out"
						 data-background-iframe="https://trailhead.salesforce.com/content/learn/modules/apex_patterns_sl/apex_patterns_sl_soc" 
						 data-background-interactive >
				</section>

				<section data-transition="fade-in fade-out">
						<h3>SOC <br/>is a collection of <br/>software design patterns</h3>
						<h6 class="fragment fade-in"><i>(it is NOT a framework!)</i></h6>
				</section>

				<section data-transition="fade-in fade-out">
						<h3 style="color:white">software framework</h3>
						<h6 style="color:white"><i> noun</i></h6> 
						<p style="color:white"><i>a collection of reusable code <br/>that implements a solution to a <br/>common problem in software design.</i></p>
				</section>				
			
			    <section data-transition="fade-in fade-out">
						<h4>The fflib Apex Common Framework</h4>
						<img src="img/fflibgithub.jpg"  style="border:none;" height="95%" width="75%"/>
				</section>

				<section data-transition="fade-in fade-out">
					<h3 style="color:white">software design pattern</h3>
					<h6 style="color:white"><i> noun</i></h6> 
					<p style="color:white"><i>a reusable solution to a <br/>common problem in software design.</i></p>
				</section>				

				<section data-transition="fade-in fade-out"
						 data-background-iframe="https://en.wikipedia.org/wiki/Software_design_pattern" 
						 data-background-interactive >

				</section>

				<section data-transition="fade-in fade-out"
						 data-background-iframe="https://trailhead.salesforce.com/content/learn/modules/apex_patterns_sl?trail_id=force_com_dev_advanced" 
						 data-background-interactive >
				</section>

				<section data-transition="fade-in fade-out">
					<h4>What patterns can <br/>help solve mondo-mania?</h4>
					<h8 class="fragment fade-in">Service Layer</h8><br/>
					<h8 class="fragment fade-in">Domain Layer</h8><br/>
					<h8 class="fragment fade-in">Selector Layer</h8><br/>
					<h8 class="fragment fade-in">Trigger Handler</h8><br/>
				</section>
	
				<section data-transition="fade-in fade-out">
					<h4>What patterns can <br/>help solve mondo-mania?</h4>
					<h8><strong>Service Layer</strong><br/>
					<h8><span style="text-decoration: line-through; color:grey">Domain Layer</span></h8><br/>
					<h8><span style="text-decoration: line-through; color:grey">Selector Layer</span></h8><br/>
					<h8><span style="text-decoration: line-through; color:grey">Trigger Handler</span></h8><br/>
				</section>				

			    <section data-transition="fade-in fade-out">
						<img src="img/apex_mondo_anti_pattern.jpg"  style="border:none;" height="95%" width="95%"/>
				</section>

			    <section data-transition="fade-in fade-out">
						<img src="img/apex_service_pattern.jpg"  style="border:none;" height="95%" width="95%"/>
				</section>

				<section data-transition="fade-in fade-out">
						<h3>What does a <br/>Service Layer <br/>look like?</h3>
				</section>

			    <section data-transition="fade-in fade-out">
						<h4>Attendee Registration Reference App</h4>
						<img src="img/tempflip-soc-events-git.jpg"  style="border:none;" height="95%" width="75%"/>
				</section>

				<section data-background-video="media/SocClipSilent.mp4" 
			 			 data-background-video-loop data-background-size="cover">
					<div class="fragment fade-out">
						<img data-src="img/SocTitle.jpg" style="opacity: 1.00" height="50%" width="50%">
					</div>
				</section>

				<section data-transition="slide-in fade-out">
					<h4>AttendeeService Class</h4>
					<style type="text/css">
						.gist {width:100% !important;}
						.gist-file
						.gist-data {max-height: 500px;max-width: 100%;}
					</style>
					<script src="https://gist.github.com/forcementor/fe627a9c5a08791cf02a6d2143edc7c3.js"></script>
	
				</section>

				<section>
						<h4>Called From a Component Controller</h4>
						<pre><code class="hljs" >
@AuraEnabled
public static Attendee saveAttendee(String attendeeJSON) {
	
    Attendee att = AttendeeService.saveAttendee(attendeeJSON);
	
    return getAttendee(att.recordId);
}
						</code></pre>
				</section>

				<section>
					<h4>Called From a Visualforce Controller</h4>
					<pre><code class="hljs" >
public PageReference saveRegistrations() {
	
   AttendeeService.saveAttendee(this.attendee);

   PageReference pr = 
        new PageReference('/' + this.attendee.recordId);

   pr.setRedirect(true);
	
   return pr;
}
					</code></pre>
				</section>
	
				<section>
					<h4>Called From a Trigger</h4>
					<pre><code class="hljs" >
trigger SessionRegistration 
		on Session_Registration__c (before insert) {
	
   AttendeeService.validateSessionRegistration(trigger.new);

}
					</code></pre>
				</section>
	
				<section data-transition="fade-in fade-out">
						<h4>What are <br/>Service Layer benefits?</h4>
						<h8 class="fragment fade-in">Decouples complexity</h8><br/>
						<h8 class="fragment fade-in">Allows reuse from multiple entry points</h8><br/>
						<h8 class="fragment fade-in">Encapsulates concern logic</h8><br/>
						<h8 class="fragment fade-in">Organizes where business logic resides</h8><br/>
				</section>
	
				<section data-transition="fade-in fade-out">
						<h4>When is a Service Layer <br/>worth the effort?</h4>
						<h8 class="fragment fade-in">Evolving requirements</h8><br/>
						<h8 class="fragment fade-in">Growing scope of your org</h8><br/>
						<h8 class="fragment fade-in">Expanding or distributed team </h8><br/>
						<h8 class="fragment fade-in">Multiple clients</h8><br/>
						<h8 class="fragment fade-in">Building a product</h8><br/>
				</section>

				<section data-transition="fade-in fade-out">
						<h4>What are <br/>Service Layer guidelines?</h4>
						<h8 class="fragment fade-in">Must be caller agnostic</h8><br/>
						<h8 class="fragment fade-in">Must follow bulkification and limits guidelines</h8><br/>
						<h8 class="fragment fade-in">Must be maintained to avoid 'Leaks'</h8><br/>
						<h8 class="fragment fade-in">Should follow strict naming conventions</h8><br/>
						<h8 class="fragment fade-in">Should handle Unit of Work for DML transactions</h8><br/>
						<h8 class="fragment fade-in">May be synchronous or asynchronous</h8><br/>
				</section>
				
				<section data-transition="fade-in fade-out">
						<h3>Are there other kinds of services?</h3>
				</section>

				<!-- MICROSERVICES =========================================== -->

				<section data-transition="fade-in fade-out">
						<h4>When you can't do what you<br/>
							need in an Apex service,<br/>
							implement your logic as a<br/> 
							<i>microservice</i> somewhere else.<br/>
						</h4>
				</section>

				<section data-transition="fade-in fade-out">
					<h3 style="color:white">microservice</h3>
					<h6 style="color:white"><i> noun</i></h6> 
					<p style="color:white"><i>A loosely coupled, fine-grained <br/>and lightweight web service.</i></p>
				</section>				

				<section data-transition="fade-in fade-out"
							data-background-iframe="https://en.wikipedia.org/wiki/Microservices" 
							data-background-interactive >

				</section>

				<section data-transition="fade-in fade-out">
						<h4>What are Microservice guidelines?</h4>
						<h8 class="fragment fade-in">Should fulfill a single function</h8><br/>
						<h8 class="fragment fade-in">Should be light weight and independent</h8><br/>
						<h8 class="fragment fade-in">Should be written in the most efficient language</h8><br/>
						<h8 class="fragment fade-in">Should follow consistent conventions</h8><br/>
						<h8 class="fragment fade-in">Should accept and return data</h8><br/>
						<h8 class="fragment fade-in">May use synchronous or asynchronous protocol</h8><br/>
				</section>

				<section data-transition="fade-in fade-out">
						<h4>Synchronous vs Asynchronous</h4>
						<h8 class="fragment fade-in">Sync if &lt;120 secs with REST or SOAP</h8><br/>
						<h8 class="fragment fade-in">Async if &gt;120 secs using Platform Events (EDA)</h8><br/>
						<h8 class="fragment fade-in">Do what’s easiest for YOU!</h8><br/>
						<h8 class="fragment fade-in">Sync-Async Service vs. Sync-Async Apex callout</h8><br/>
				</section>

			    <section data-transition="fade-in fade-out">
						<h4>Microservice Use Case</h4>
						<img src="img/microservice_use_case.png"  style="border:none;" height="95%" width="75%"/>
				</section>

			    <section data-transition="fade-in fade-out">
						<img src="img/remittance_process_seq.jpg"  style="border:none;" height="95%" width="95%"/>
				</section>

			    <section data-transition="fade-in fade-out">
						<h4>Async Call Out</h4>
						<img src="img/microservice_use_case_async.png"  style="border:none;" height="95%" width="95%"/>
				</section>

				<section data-transition="slide-in fade-out">
					<h4>MicroserviceManagerDemo Class</h4>
					<style type="text/css">
						.gist {width:100% !important;}
						.gist-file
						.gist-data {max-height: 500px;max-width: 100%;}
					</style>
					<script src="https://gist.github.com/forcementor/81678cca6c1c67865307b4ba75cc9752.js"></script>
				</section>

				<section data-transition="slide-in fade-out">
					<h4>MicroserviceManager Class</h4>
					<style type="text/css">
						.gist {width:100% !important;}
						.gist-file
						.gist-data {max-height: 500px;max-width: 100%;}
					</style>
					<script src="https://gist.github.com/forcementor/754efb1e2a6cfbb42f087d38761c6a12.js"></script>
				</section>

				<section data-transition="slide-in fade-out">
					<h4>PDF-Convert Web Service</h4>
					<a href="https://github.com/forcementor/pdf-convert" target="_none">
						<img src="img/pdf-convert-git.jpg" style="border:none;" height="95%" width="75%"/>
					</a>
				</section>

				<section >
					<h4>http://bit.ly/PuntaDreaminMicroSvcs</h4>
					<iframe width="853" height="480" src="https://www.youtube.com/embed/O-Ohni7wEKA?start=160" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
				</section>

				<section data-transition="fade-in fade-out">
						<h3>Want some more <br/>stuff to chew on?</h3>
				</section>

				<section data-transition="slide-in fade-out">
					<h4>Understanding Apex Enterprise Patterns and Separation of Concerns in Salesforce</h4>
					<h8>with Peter Tempfli</h2>
					<br/>	
					<a href="http://bit.ly/SfPlayByPlay22" target="_none"> 
						<img src="img/peter.jpg" style="border:none;" width="60%" />
					</a>	
				</section>
	
				<section data-transition="slide-in fade-out">
					<h4>Apex SOC Course Channel</h4>
					<h8>bit.ly/ApexSOC</h8>
					<br/>	
					<img src="img/ApexSocChannel.jpg" style="border:none;" width="60%" />
				</section>

				<section data-transition="slide-in fade-out">
					<h4>Adopting Trigger Design Patterns <br/>in Existing Salesforce Orgs</h4>
					<h8>with Dan Appleman</h2>
					<br/>	
					<img src="img/dan.jpg" style="border:none;" width="60%" />
				</section>

				<section data-transition="slide-in fade-out">
					<h4>Getting on the Bus - Event Based Architecture with Salesforce Platform Events</h4>
					<h8>with Simon Goodyear</h2>
					<br/>	
					<img src="img/simon.jpg" style="border:none;" width="60%" />
				</section>
	
				<section data-transition="slide-in fade-out">
					<h4>Maximize Your Value Through <br/>Salesforce Coding Best Practices</h4>
					<h8>with Matt Kaufman</h2>
					<br/>	
					<img src="img/matt.jpg" style="border:none;" width="60%" />
				</section>
	
				<section data-transition="slide-in fade-out">
					<h4>Understanding Heroku Myths and Magic</h4>
					<h8>with Lyric Hartley</h2>
					<br/>	
					<img src="img/lyric.jpg" style="border:none;" width="60%" />
				</section>
	
				<section >
					<h4>Salesforce Play By Plays <br/>Youtube Playlist</h4>
					<a href="http://bit.ly/sfplaybyplaylist" target="_none">
						<img src="img/playbyplay-list.jpg" style="border:none;" width="60%" />
					</a>
				</section>

				<section style="text-align: left;">
					<h3>Thanks!</h3>
				</section>
	
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				slideNumber: 'c/t',
				autoPlayMedia: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/search/search.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
